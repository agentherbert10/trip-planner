<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hawaii Trip Planner</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      color: #333;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    header h1 {
      font-size: 32px;
      margin-bottom: 5px;
    }
    
    header p {
      font-size: 14px;
      opacity: 0.9;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #ddd;
    }
    
    .tab-btn {
      padding: 12px 20px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 16px;
      border-bottom: 3px solid transparent;
      transition: all 0.2s;
      color: #666;
    }
    
    .tab-btn.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }
    
    .tab-btn:hover {
      color: #667eea;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .flight-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      border-left: 4px solid #667eea;
    }
    
    .flight-card h3 {
      margin-bottom: 10px;
      color: #667eea;
    }
    
    .flight-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .flight-info div {
      font-size: 14px;
    }
    
    .flight-info strong {
      display: block;
      color: #667eea;
      margin-bottom: 5px;
    }
    
    .section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .section h2 {
      margin-bottom: 20px;
      color: #333;
      font-size: 20px;
    }
    
    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .input-group input,
    .input-group textarea,
    .input-group select {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      font-family: inherit;
    }
    
    .input-group button {
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s;
    }
    
    .input-group button:hover {
      background: #5568d3;
    }
    
    .item-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .item {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      gap: 12px;
      border: 1px solid #eee;
    }
    
    .item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    
    .item.completed {
      opacity: 0.6;
      text-decoration: line-through;
    }
    
    .item-content {
      flex: 1;
    }
    
    .item-date {
      font-size: 12px;
      color: #999;
    }
    
    .item-delete {
      background: #ff6b6b;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.2s;
    }
    
    .item-delete:hover {
      background: #ff5252;
    }
    
    #map {
      width: 100%;
      height: 500px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .restaurant-item {
      background: #f9f9f9;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 10px;
      border-left: 3px solid #667eea;
    }
    
    .restaurant-item h4 {
      margin-bottom: 5px;
      color: #333;
    }
    
    .restaurant-item p {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    
    .restaurant-item.visited {
      background: #e6f3ff;
      border-left-color: #4caf50;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    function TripPlanner() {
      const [activeTab, setActiveTab] = useState('itinerary');
      const [itinerary, setItinerary] = useState([]);
      const [packing, setPacking] = useState([]);
      const [restaurants, setRestaurants] = useState([]);
      const [packingFilter, setPackingFilter] = useState('All');
      const mapRef = useRef(null);
      const mapInstanceRef = useRef(null);

      // Load data from localStorage on mount
      useEffect(() => {
        const defaultPackingItems = [
          { item: 'Amex platinum card', category: 'Other', person: 'Justin' },
          { item: 'Costco card', category: 'Other', person: 'Justin' },
          { item: 'Running shoes', category: 'Clothes', person: 'Justin' },
          { item: '3 running shorts', category: 'Clothes', person: 'Justin' },
          { item: '2 swim trunks', category: 'Clothes', person: 'Justin' },
          { item: 'White linen shirt', category: 'Clothes', person: 'Justin' },
          { item: 'SD button up shirt', category: 'Clothes', person: 'Justin' }
        ];

        const defaultItinerary = [
          { date: '2026-03-04', time: '07:45', activity: 'üé≠ Cast Breakfast' }
        ];

        const saved = localStorage.getItem('tripData');
        if (saved) {
          const data = JSON.parse(saved);
          
          // Merge default packing items with saved ones (avoiding duplicates)
          const savedPackingItems = data.packing || [];
          const savedItemNames = new Set(savedPackingItems.map(p => p.item.toLowerCase()));
          const mergedPacking = [
            ...savedPackingItems,
            ...defaultPackingItems
              .filter(item => !savedItemNames.has(item.item.toLowerCase()))
              .map(item => ({ id: Date.now() + Math.random(), ...item, packed: false }))
          ];

          // Merge default itinerary with saved ones (avoiding duplicates)
          const savedItineraryItems = data.itinerary || [];
          const savedActivities = new Set(savedItineraryItems.map(i => i.activity.toLowerCase()));
          const mergedItinerary = [
            ...savedItineraryItems,
            ...defaultItinerary
              .filter(item => !savedActivities.has(item.activity.toLowerCase()))
              .map(item => ({ id: Date.now() + Math.random(), ...item }))
          ];

          setItinerary(mergedItinerary);
          setPacking(mergedPacking);
          setRestaurants(data.restaurants || []);
        } else {
          // First load: initialize with defaults
          setItinerary(
            defaultItinerary.map((item, i) => ({ id: Date.now() + i, ...item }))
          );
          setPacking(
            defaultPackingItems.map((item, i) => ({ id: Date.now() + i, ...item, packed: false }))
          );
        }
      }, []);

      // Save data to localStorage whenever it changes
      useEffect(() => {
        localStorage.setItem('tripData', JSON.stringify({ itinerary, packing, restaurants }));
      }, [itinerary, packing, restaurants]);

      // Initialize map
      useEffect(() => {
        if (activeTab === 'restaurants' && mapRef.current && !mapInstanceRef.current) {
          mapInstanceRef.current = L.map(mapRef.current).setView([20.8, -156.5], 8);
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 19,
          }).addTo(mapInstanceRef.current);
        }
      }, [activeTab]);

      // Add restaurant markers to map
      useEffect(() => {
        if (mapInstanceRef.current) {
          // Clear existing markers
          mapInstanceRef.current.eachLayer((layer) => {
            if (layer instanceof L.Marker) {
              mapInstanceRef.current.removeLayer(layer);
            }
          });

          // Add new markers
          restaurants.forEach((r) => {
            if (r.lat && r.lng) {
              const marker = L.marker([r.lat, r.lng]).addTo(mapInstanceRef.current);
              const visited = r.visited ? '‚úì ' : '';
              marker.bindPopup(`<b>${visited}${r.name}</b><br>${r.location}`);
            }
          });
        }
      }, [restaurants, activeTab]);

      // Itinerary functions
      const addItineraryItem = (date, time, activity) => {
        if (date && activity) {
          setItinerary([...itinerary, { id: Date.now(), date, time, activity }]);
        }
      };

      const deleteItineraryItem = (id) => {
        setItinerary(itinerary.filter((item) => item.id !== id));
      };

      // Packing functions
      const addPackingItem = (item, category = 'Other', person = 'Justin') => {
        if (item) {
          setPacking([...packing, { id: Date.now(), item, category, person, packed: false }]);
        }
      };

      const togglePacking = (id) => {
        setPacking(
          packing.map((p) =>
            p.id === id ? { ...p, packed: !p.packed } : p
          )
        );
      };

      const deletePackingItem = (id) => {
        setPacking(packing.filter((item) => item.id !== id));
      };

      // Restaurant functions
      const addRestaurant = (name, location, lat, lng) => {
        if (name && location) {
          setRestaurants([
            ...restaurants,
            { id: Date.now(), name, location, lat, lng, visited: false },
          ]);
        }
      };

      const toggleRestaurant = (id) => {
        setRestaurants(
          restaurants.map((r) =>
            r.id === id ? { ...r, visited: !r.visited } : r
          )
        );
      };

      const deleteRestaurant = (id) => {
        setRestaurants(restaurants.filter((r) => r.id !== id));
      };

      return (
        <div className="container">
          <header>
            <h1>Hawaii Trip 2026</h1>
            <p>Feb 27 - Mar 7 | San Diego ‚Üí Honolulu</p>
          </header>

          <div className="tabs">
            <button
              className={`tab-btn ${activeTab === 'itinerary' ? 'active' : ''}`}
              onClick={() => setActiveTab('itinerary')}
            >
              Itinerary
            </button>
            <button
              className={`tab-btn ${activeTab === 'packing' ? 'active' : ''}`}
              onClick={() => setActiveTab('packing')}
            >
              Packing List
            </button>
            <button
              className={`tab-btn ${activeTab === 'restaurants' ? 'active' : ''}`}
              onClick={() => setActiveTab('restaurants')}
            >
              Restaurants
            </button>
          </div>

          {/* Itinerary Tab */}
          <div className={`tab-content ${activeTab === 'itinerary' ? 'active' : ''}`}>
            <div className="section">
              <h2>Flights</h2>
              <div className="flight-card">
                <h3>‚úàÔ∏è Departure - Feb 27</h3>
                <div className="flight-info">
                  <div>
                    <strong>WN 1295</strong>
                    San Diego (SAN) ‚Üí Honolulu (HNL)
                  </div>
                  <div>
                    <strong>4:40 PM PST ‚Üí 9:00 PM HST</strong>
                    Flight time: 6h 20m
                  </div>
                </div>
              </div>

              <div className="flight-card">
                <h3>‚úàÔ∏è Return - Mar 7</h3>
                <div className="flight-info">
                  <div>
                    <strong>WN 2956</strong>
                    Honolulu (HNL) ‚Üí San Diego (SAN)
                  </div>
                  <div>
                    <strong>9:00 AM HST ‚Üí 4:30 PM PST</strong>
                  </div>
                </div>
              </div>
            </div>

            <div className="section">
              <h2>üè® Accommodations</h2>
              <div className="item-list">
                <div className="item">
                  <div className="item-content">
                    <strong>Sheraton Waikiki Beach Resort</strong>
                    <div className="item-date">Feb 27 - Mar 1 (2 nights)</div>
                  </div>
                </div>
                <div className="item">
                  <div className="item-content">
                    <strong>Four Seasons Resort Oahu at Ko Olina</strong>
                    <div className="item-date">Mar 1 - Mar 3 (2 nights)</div>
                  </div>
                </div>
                <div className="item">
                  <div className="item-content">
                    <strong>Aulani, A Disney Resort & Spa</strong>
                    <div className="item-date">Mar 3 - Mar 7 (4 nights)</div>
                  </div>
                </div>
              </div>
            </div>

            <div className="section">
              <h2>Activities & Events</h2>
              <ItineraryForm onAdd={addItineraryItem} />
              <div className="item-list">
                {itinerary
                  .sort((a, b) => new Date(a.date) - new Date(b.date))
                  .map((item) => (
                    <div key={item.id} className="item">
                      <div className="item-content">
                        <strong>{item.activity}</strong>
                        <div className="item-date">
                          {new Date(item.date).toLocaleDateString()} {item.time && `@ ${item.time}`}
                        </div>
                      </div>
                      <button
                        className="item-delete"
                        onClick={() => deleteItineraryItem(item.id)}
                      >
                        Delete
                      </button>
                    </div>
                  ))}
              </div>
            </div>
          </div>

          {/* Packing Tab */}
          <div className={`tab-content ${activeTab === 'packing' ? 'active' : ''}`}>
            <div className="section">
              <h2>Packing Checklist</h2>
              
              {/* Segment Control */}
              <div style={{ display: 'flex', gap: '8px', marginBottom: '20px', backgroundColor: '#f0f0f0', padding: '4px', borderRadius: '6px', width: 'fit-content' }}>
                {['All', 'Justin', 'Eunice', 'Codie'].map((person) => (
                  <button
                    key={person}
                    onClick={() => setPackingFilter(person)}
                    style={{
                      padding: '8px 16px',
                      border: 'none',
                      borderRadius: '4px',
                      background: packingFilter === person ? '#667eea' : 'transparent',
                      color: packingFilter === person ? 'white' : '#333',
                      cursor: 'pointer',
                      fontWeight: packingFilter === person ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                  >
                    {person}
                  </button>
                ))}
              </div>

              <PackingForm onAdd={addPackingItem} />
              {(() => {
                // Filter by person first
                const filtered = packingFilter === 'All' 
                  ? packing 
                  : packing.filter((item) => item.person === packingFilter);
                
                // Then group by category
                const grouped = {};
                filtered.forEach((item) => {
                  const cat = item.category || 'Other';
                  if (!grouped[cat]) grouped[cat] = [];
                  grouped[cat].push(item);
                });
                
                return Object.keys(grouped)
                  .sort()
                  .map((category) => (
                    <div key={category} style={{ marginBottom: '20px' }}>
                      <h3 style={{ fontSize: '16px', color: '#667eea', marginBottom: '10px' }}>
                        {category}
                      </h3>
                      <div className="item-list">
                        {grouped[category].map((item) => (
                          <div
                            key={item.id}
                            className={`item ${item.packed ? 'completed' : ''}`}
                          >
                            <input
                              type="checkbox"
                              checked={item.packed}
                              onChange={() => togglePacking(item.id)}
                            />
                            <span className="item-content">{item.item}</span>
                            <button
                              className="item-delete"
                              onClick={() => deletePackingItem(item.id)}
                            >
                              Delete
                            </button>
                          </div>
                        ))}
                      </div>
                    </div>
                  ));
              })()}
            </div>
          </div>

          {/* Restaurants Tab */}
          <div className={`tab-content ${activeTab === 'restaurants' ? 'active' : ''}`}>
            <div className="section">
              <div id="map" ref={mapRef}></div>
              <h2>Restaurants to Visit</h2>
              <RestaurantForm onAdd={addRestaurant} />
              <div className="item-list">
                {restaurants.map((r) => (
                  <div
                    key={r.id}
                    className={`restaurant-item ${r.visited ? 'visited' : ''}`}
                  >
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>
                      <div style={{ flex: 1 }}>
                        <h4>{r.visited ? '‚úì ' : ''}{r.name}</h4>
                        <p>{r.location}</p>
                      </div>
                      <button
                        style={{
                          marginRight: '10px',
                          padding: '6px 12px',
                          background: r.visited ? '#4caf50' : '#999',
                          color: 'white',
                          border: 'none',
                          borderRadius: '4px',
                          cursor: 'pointer',
                          fontSize: '12px',
                        }}
                        onClick={() => toggleRestaurant(r.id)}
                      >
                        {r.visited ? 'Visited' : 'Mark Visited'}
                      </button>
                      <button
                        className="item-delete"
                        onClick={() => deleteRestaurant(r.id)}
                      >
                        Delete
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    function ItineraryForm({ onAdd }) {
      const [date, setDate] = useState('');
      const [time, setTime] = useState('');
      const [activity, setActivity] = useState('');

      const handleSubmit = () => {
        onAdd(date, time, activity);
        setDate('');
        setTime('');
        setActivity('');
      };

      return (
        <div className="input-group">
          <input
            type="date"
            value={date}
            onChange={(e) => setDate(e.target.value)}
            placeholder="Date"
          />
          <input
            type="time"
            value={time}
            onChange={(e) => setTime(e.target.value)}
            placeholder="Time"
          />
          <input
            type="text"
            value={activity}
            onChange={(e) => setActivity(e.target.value)}
            placeholder="Activity"
          />
          <button onClick={handleSubmit}>Add</button>
        </div>
      );
    }

    function PackingForm({ onAdd }) {
      const [item, setItem] = useState('');
      const [category, setCategory] = useState('Other');
      const [person, setPerson] = useState('Justin');

      const handleSubmit = () => {
        onAdd(item, category, person);
        setItem('');
      };

      return (
        <div className="input-group">
          <input
            type="text"
            value={item}
            onChange={(e) => setItem(e.target.value)}
            placeholder="Add item to packing list..."
          />
          <select value={person} onChange={(e) => setPerson(e.target.value)}>
            <option value="Justin">Justin</option>
            <option value="Eunice">Eunice</option>
            <option value="Codie">Codie</option>
          </select>
          <select value={category} onChange={(e) => setCategory(e.target.value)}>
            <option value="Clothes">Clothes</option>
            <option value="Toiletries">Toiletries</option>
            <option value="Documents">Documents</option>
            <option value="Other">Other</option>
          </select>
          <button onClick={handleSubmit}>Add</button>
        </div>
      );
    }

    function RestaurantForm({ onAdd }) {
      const [name, setName] = useState('');
      const [location, setLocation] = useState('');
      const [lat, setLat] = useState('');
      const [lng, setLng] = useState('');

      const handleSubmit = () => {
        onAdd(name, location, parseFloat(lat) || null, parseFloat(lng) || null);
        setName('');
        setLocation('');
        setLat('');
        setLng('');
      };

      return (
        <>
          <div className="input-group">
            <input
              type="text"
              value={name}
              onChange={(e) => setName(e.target.value)}
              placeholder="Restaurant name"
            />
            <input
              type="text"
              value={location}
              onChange={(e) => setLocation(e.target.value)}
              placeholder="Location/Address"
            />
            <button onClick={handleSubmit}>Add Restaurant</button>
          </div>
          <div style={{ fontSize: '12px', color: '#999', marginBottom: '20px' }}>
            üí° Tip: Click on the map to get coordinates, then add them to place the restaurant on the map
          </div>
          <div className="input-group">
            <input
              type="number"
              step="0.0001"
              value={lat}
              onChange={(e) => setLat(e.target.value)}
              placeholder="Latitude (optional)"
            />
            <input
              type="number"
              step="0.0001"
              value={lng}
              onChange={(e) => setLng(e.target.value)}
              placeholder="Longitude (optional)"
            />
          </div>
        </>
      );
    }

    ReactDOM.render(<TripPlanner />, document.getElementById('root'));
  </script>
</body>
</html>
